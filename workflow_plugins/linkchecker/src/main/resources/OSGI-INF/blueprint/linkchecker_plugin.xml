<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">



	<!-- The Thumbler (thumbnail caching plugin) constitues a separate implementation, 
		which is however based on TEL's synchronous threadpooling mechanism. In the 
		blueprint definition, both the Linchecking and Thumbler (image caching) workflows 
		are exported. -->
	<bean id="thumbler" class="eu.europeana.uim.plugin.thumbler.service.ThumblerPlugin">
	  <argument ref="registry" />
	</bean>

	<!-- Export the thumblerPlugin as a service -->
	<service id="thumblerPlugin" ref="thumbler"
		interface="eu.europeana.uim.plugin.ingestion.IngestionPlugin" />

	<!-- The Linkchecker Plugin from Tel is directly used as as an embedded 
		dependency -->

	<bean id="linkchecker"
		class="org.theeuropeanlibrary.uim.check.weblink.LinkCheckIngestionPlugin">
		<argument ref="registry" />
	</bean>

	<!-- Export the linkCheckerPlugin as a service -->
	<service id="linkCheckerPlugin" ref="linkchecker"
		interface="eu.europeana.uim.plugin.ingestion.IngestionPlugin" />


	<!-- Workflows Definitions -->
	<!-- Export the LinckCheckingWorkfow as a service -->
	<bean id="lcw"
		class="org.theeuropeanlibrary.uim.check.weblink.LinkCheckWorkflow" />
	<service id="linkCheckingWorkflow" ref="lcw"
		interface="eu.europeana.uim.workflow.Workflow" />

	<!-- Export the ImageCacheWorkflow as a service -->
	<bean id="thw"
		class="eu.europeana.uim.plugin.thumbler.workflows.ImageCacheWorkflow" />
	<service id="imageCacheWorkflow" ref="thw"
		interface="eu.europeana.uim.workflow.Workflow" />

	<reference id="registry" interface="eu.europeana.uim.Registry" />

	<reference id="sugar" interface="eu.europeana.uim.sugar.SugarService"
		availability="optional">
		<reference-listener bind-method="setSugarService"
			unbind-method="unsetSugarService" ref="linkchecker">
		</reference-listener>
	</reference>

    <bean id="linkadapter" class="eu.europeana.uim.plugin.thumbler.converters.LinkcheckerAdapter"/>

	<service id="linkadapterservice" ref="linkadapter"
		interface="eu.europeana.uim.adapter.UimDatasetAdapter" />
	
	<!-- 	
	<bean id="thumbleradapter" class="eu.europeana.uim.plugin.thumbler.converters.ThumblerAdapter"/>

	<service id="thumbleradapterservice" ref="thumbleradapter"
		interface="eu.europeana.uim.adapter.UimDatasetAdapter" />	
	 -->	

</blueprint>
